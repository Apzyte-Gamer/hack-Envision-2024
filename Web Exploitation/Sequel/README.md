Sequel
=

Ever feared of injections? Me too.

### Website: https://sqlite-injection.ctf.teamquark.com/

(Point rush challenge)

### Author: Harsh Patil

### Files: [web_sequel.zip](./web_sequel.zip)

Solution
=

Looking at the name of the challenge, we pretty well know that we have to implement a SQL injection in order to get the flag. I looked at the source code and found out that we would have to leak a table to get the flag, which can also be noticed in database.db.

I then started to contstruct the query keeping in mind the is_invalid_query() function.

```py
def is_invalid_query(query: str) -> bool:
    if query.lower().count("insert") > 1:
        return True

    if "drop" in query.lower():
        return True

    if "delete" in query.lower():
        return True

    return False
```

I started my query search from `admin" OR '1'='1'--`, but this didnt work. So, I went on researching and ChatGPTing. I basicaly wanted to make a SQLi which would check for the name row and leak it. I did that by making the 1st half of the query `admin" OR '1'='1' UNION ALL SELECT name`.

Now, I need to include from which element and which type of info I'm leaking and I do this by the second half `'1' FROM sqlite_master WHERE type='table'`.

Since we dont have the password, we can simply add a `--` at the end of the query to stop the checking of the password.

And finally, ater finally a long time, I got my final query as `admin" OR '1'='1' UNION ALL SELECT name,'1' FROM sqlite_master WHERE type='table'--`. Putting this as the username and putting random stuff in the password gave us our flag!

`quarkCTF{pr3v3nt_m3_by_pr3p4r3d_5t4t3m3nt5}`
